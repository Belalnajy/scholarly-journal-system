# ูุธุงู ุงูุชุนุฏููุงุช - ุฏููู ุดุงูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ุชุนุฏููุงุช ุงูุฃุจุญุงุซ ุงูุนูููุฉุ ูุณูุญ ููุจุงุญุซูู ุจุชุนุฏูู ุฃุจุญุงุซูู ุจูุงุกู ุนูู ููุงุญุธุงุช ุงููุญูููู ูุงููุญุฑุฑูู.

## ๐ฏ ุงููุดููุฉ ุงูุชู ุชู ุญููุง

**ูุจู ุงูุชุญุฏูุซ:**
- ุงูุจุงุญุซ ูุง ูุฑู ุจูุงูุงุช ุจุญุซู ุงูุฃุตููุฉ ุนูุฏ ุงูุชุนุฏูู
- ูุง ููุฌุฏ ูุธุงู ูุชุชุจุน ุงูุชุนุฏููุงุช
- ุงูููู ุงูุฌุฏูุฏ ูุง ูุญู ูุญู ุงููุฏูู ุจุดูู ุตุญูุญ
- ูุง ูุชู ุญูุธ ุณุฌู ุงูุชุนุฏููุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุจุนุฏ ุงูุชุญุฏูุซ:**
- โ ุงูุจุงุญุซ ูุฑู ุฌููุน ุจูุงูุงุช ุจุญุซู ุงูุฃุตููุฉ
- โ ูุธุงู ูุชูุงูู ูุชุชุจุน ุงูุชุนุฏููุงุช ูุน ุฃุฑูุงู ุงููุฑุงุฌุนุงุช
- โ ุงูููู ุงูุฌุฏูุฏ ูุญู ูุญู ุงููุฏูู ุชููุงุฆูุงู
- โ ุฌููุน ุงูุชุนุฏููุงุช ูุญููุธุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### ูููุงุช ุฌุฏูุฏุฉ
1. **`/apps/frontend/src/services/research-revisions.service.ts`**
   - ุฎุฏูุฉ ูุงููุฉ ููุชุนุงูู ูุน ุงูุชุนุฏููุงุช
   - ุฌููุน ุงูุนูููุงุช CRUD
   - ุชูุงูู ูุน ุงูู backend

### ูููุงุช ูุนุฏูุฉ
1. **`/apps/frontend/src/pages/dashboard/ReviseResearchPage.tsx`**
   - ุชุญููู ุงูุจูุงูุงุช ุงูุฃุตููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุนุฑุถ ููุงุญุธุงุช ุงููุญูููู
   - ูุธุงู ุฑูุน ุงููููุงุช ุงููุญุณู
   - ุญูุธ ุงูุชุนุฏููุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

2. **`/apps/frontend/src/pages/dashboard/PendingDecisionPage.tsx`**
   - ุฅูุดุงุก ุทูุจ ุชุนุฏูู ุชููุงุฆู
   - ุชูุงูู ูุน ูุธุงู ุงูุชุนุฏููุงุช
   - ุญูุธ ููุงุญุธุงุช ุงููุญุฑุฑ

### ูููุงุช ุชูุซูู
1. **`REVISION_SYSTEM_UPDATES.md`** - ุดุฑุญ ุชูุตููู ููุชุญุฏูุซุงุช
2. **`REVISION_SUMMARY_AR.md`** - ููุฎุต ุจุงูุนุฑุจูุฉ
3. **`TESTING_GUIDE_AR.md`** - ุฏููู ุงูุงุฎุชุจุงุฑ
4. **`REVISION_SYSTEM_README.md`** - ูุฐุง ุงูููู

## ๐ ุชุฏูู ุงูุนูู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. ุงููุญุฑุฑ ูุทูุจ ุชุนุฏููุงุช                                     โ
โ    - ูุฑุงุฌุน ุชููููุงุช ุงููุญูููู                                 โ
โ    - ูุฎุชุงุฑ "ูุชุทูุจ ุชุนุฏูู"                                   โ
โ    - ููุชุจ ุงูุชุนุฏููุงุช ุงููุทููุจุฉ                               โ
โ    - ูุชู ุฅูุดุงุก ุณุฌู ูู research_revisions                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. ุงูุจุงุญุซ ูุนุฏู ุงูุจุญุซ                                       โ
โ    - ููุชุญ ุตูุญุฉ ุงูุชุนุฏูู                                     โ
โ    - ูุฑู ุจูุงูุงุช ุจุญุซู ุงูุฃุตููุฉ                              โ
โ    - ูุฑู ููุงุญุธุงุช ุงููุญูููู ูุงูุชุนุฏููุงุช ุงููุทููุจุฉ             โ
โ    - ูุฑูุน ููู PDF ุฌุฏูุฏ                                     โ
โ    - ููุชุจ ููุงุญุธุงุชู ุญูู ุงูุชุนุฏููุงุช                          โ
โ    - ูุฑุณู ุงููุณุฎุฉ ุงููุนุฏูุฉ                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3. ุงููุธุงู ูุญุฏุซ ุงูุจูุงูุงุช ุชููุงุฆูุงู                           โ
โ    - ุชุญุฏูุซ file_url ูู ุฌุฏูู research                       โ
โ    - ุชุญุฏูุซ ุญุงูุฉ ุงูุชุนุฏูู โ submitted                        โ
โ    - ุฅุนุงุฏุฉ ุชุนููู ุงููุฑุงุฌุนุงุช โ pending                       โ
โ    - ุฅุนุงุฏุฉ ุชุนููู ุงููุญูููู โ accepted                       โ
โ    - ุชุญุฏูุซ ุญุงูุฉ ุงูุจุญุซ โ under-review                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 4. ุงููุญูููู ูุฑุงุฌุนูู ุงููุณุฎุฉ ุงููุนุฏูุฉ                         โ
โ    - ูุฑูู ุงูุจุญุซ ูู ููุญุชูู ูุฑุฉ ุฃุฎุฑู                        โ
โ    - ูุฑุงุฌุนูู ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ                                โ
โ    - ููุฏููู ุชููููุงุชูู                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 5. ุงููุญุฑุฑ ูุชุฎุฐ ุงููุฑุงุฑ ุงูููุงุฆู                              โ
โ    - ูุจูู ุงูุจุญุซ ูููุดุฑ                                      โ
โ    - ุฃู ุทูุจ ุชุนุฏููุงุช ุฅุถุงููุฉ (ุชูุฑุงุฑ ุงูุนูููุฉ)                โ
โ    - ุฃู ุฑูุถ ุงูุจุญุซ                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู research_revisions
```sql
CREATE TABLE research_revisions (
  id UUID PRIMARY KEY,
  research_id UUID REFERENCES research(id) ON DELETE CASCADE,
  revision_number INTEGER NOT NULL,
  revision_notes TEXT NOT NULL,
  file_url TEXT,
  status VARCHAR(50) DEFAULT 'pending',
  deadline TIMESTAMP,
  submitted_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### ุงูุชุญุฏูุซุงุช ุนูู ุฌุฏูู research
```sql
-- ุนูุฏ ุฅุฑุณุงู ุงูุชุนุฏููุ ูุชู ุชุญุฏูุซ:
UPDATE research 
SET 
  file_url = 'ุฑุงุจุท ุงูููู ุงูุฌุฏูุฏ',
  status = 'under-review',
  updated_at = NOW()
WHERE id = 'xxx';
```

## ๐ API Endpoints

### Research Revisions
```
POST   /research-revisions              ุฅูุดุงุก ุทูุจ ุชุนุฏูู
GET    /research-revisions              ุฌูุจ ุฌููุน ุงูุชุนุฏููุงุช
GET    /research-revisions/:id          ุฌูุจ ุชุนุฏูู ูุญุฏุฏ
PUT    /research-revisions/:id          ุชุญุฏูุซ ุชุนุฏูู
PUT    /research-revisions/:id/submit   ุฅุฑุณุงู ุงูุชุนุฏูู ูุน ุงูููู
PUT    /research-revisions/:id/approve  ุงูููุงููุฉ ุนูู ุงูุชุนุฏูู
PUT    /research-revisions/:id/reject   ุฑูุถ ุงูุชุนุฏูู
DELETE /research-revisions/:id          ุญุฐู ุชุนุฏูู
```

### Research
```
GET    /research/:id                    ุฌูุจ ุจูุงูุงุช ุงูุจุญุซ
PATCH  /research/:id                    ุชุญุฏูุซ ุงูุจุญุซ
PATCH  /research/:id/status             ุชุญุฏูุซ ุญุงูุฉ ุงูุจุญุซ
```

### Reviews & Assignments
```
GET    /reviews?research_id=xxx         ุฌูุจ ุงููุฑุงุฌุนุงุช
PATCH  /reviews/:id/status              ุชุญุฏูุซ ุญุงูุฉ ุงููุฑุงุฌุนุฉ
GET    /reviewer-assignments?research_id=xxx
PATCH  /reviewer-assignments/:id/status
```

## ๐ป ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ุฅูุดุงุก ุทูุจ ุชุนุฏูู (ูู ุงููุญุฑุฑ)
```typescript
const revision = await researchRevisionsService.create({
  research_id: 'research-uuid',
  revision_notes: 'ูุฑุฌู ุชุญุณูู ุงููููุฌูุฉ ูุฅุถุงูุฉ ูุฑุงุฌุน',
  deadline: '2024-03-15'
});
```

### ุฌูุจ ุขุฎุฑ ุชุนุฏูู ูุนูู (ููุจุงุญุซ)
```typescript
const revision = await researchRevisionsService.getLatestPendingRevision(
  'research-uuid'
);

if (revision) {
  console.log('ุงูุชุนุฏููุงุช ุงููุทููุจุฉ:', revision.revision_notes);
  console.log('ุฑูู ุงููุฑุงุฌุนุฉ:', revision.revision_number);
}
```

### ุฅุฑุณุงู ุงูุชุนุฏูู (ูู ุงูุจุงุญุซ)
```typescript
// 1. ุฑูุน ุงูููู (TODO: ุชูุงูู ูุน S3)
const fileUrl = await uploadFile(file);

// 2. ุฅุฑุณุงู ุงูุชุนุฏูู
await researchRevisionsService.submit(revisionId, fileUrl);

// 3. ุชุญุฏูุซ ุงูุจุญุซ
await researchService.update(researchId, {
  file_url: fileUrl
});

// 4. ุฅุนุงุฏุฉ ุชุนููู ุงููุฑุงุฌุนุงุช
await resetReviewsAndAssignments(researchId);

// 5. ุชุญุฏูุซ ุญุงูุฉ ุงูุจุญุซ
await researchService.updateStatus(researchId, 'under-review');
```

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุตูุญุฉ ุงูุชุนุฏูู (ReviseResearchPage)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุชุนุฏูู ุงูุจุญุซ                                               โ
โ ุชุทุจููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุชุนููู                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงูุจุญุซ ูุญุชุงุฌ ุฅูู ุชุนุฏููุงุช ุจูุงุกู ุนูู ููุงุญุธุงุช ุงููุญูููู   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ููุงุญุธุงุช ุงููุญูููู                                          โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ โ ๐ค ุฏ. ูุญูุฏ ุฃุญูุฏ                    โญ 4.5/5         โ   โ
โ โ ุงูุชูุตูุฉ: ูุญุชุงุฌ ุชุนุฏููุงุช                              โ   โ
โ โ ุงูููุงุญุธุงุช: ูุฌุจ ุชุญุณูู ุงููููุฌูุฉ...                   โ   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุฑูุน ุงููุณุฎุฉ ุงููุนุฏูุฉ                                        โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ โ ููุงุญุธุงุช ุงูุจุงุญุซ *                                    โ   โ
โ โ [ุชู ุฅุฌุฑุงุก ุงูุชุนุฏููุงุช ุงูุชุงููุฉ...]                    โ   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ โ ๐ ุฑูุน ููู PDF *                                    โ   โ
โ โ [ุงุณุญุจ ูุฃููุช ุงูููู ููุง]                             โ   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ูุนูููุงุช ุงูุจุญุซ ุงูุฃุตูู                                     โ
โ ุฑูู ุงูุจุญุซ: RES-2024-0001                                  โ
โ ุงูุนููุงู: ุชุทุจููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุชุนููู             โ
โ ุงูุชุฎุตุต: ุชูููุฉ ุงููุนูููุงุช                                  โ
โ ุฑูู ุงููุฑุงุฌุนุฉ: #1                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ [ุฅุฑุณุงู ุงููุณุฎุฉ ุงููุนุฏูุฉ] [ุฅูุบุงุก]                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ูุงูุชุฎุตูุต

### ุชุบููุฑ ูุฏุฉ ุงูู Deadline
ูู `PendingDecisionPage.tsx`:
```typescript
// ุญุงููุงู: 30 ููู
deadline: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)

// ูุชุบููุฑูุง ุฅูู 45 ููู:
deadline: new Date(Date.now() + 45 * 24 * 60 * 60 * 1000)
```

### ุชุฎุตูุต ุฑุณุงุฆู ุงููุฌุงุญ
ูู `ReviseResearchPage.tsx`:
```typescript
alert('ุชู ุฅุฑุณุงู ุงููุณุฎุฉ ุงููุนุฏูุฉ ุจูุฌุงุญ! ุณูุชู ูุฑุงุฌุนุชูุง ูู ูุจู ููุณ ุงููุญูููู.');
```

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (TODO)
```typescript
// ูู ุงูู backendุ ูุฌุจ ุฅุถุงูุฉ:
@UseGuards(AuthGuard, RoleGuard)
@Roles('researcher')
async submitRevision(@Param('id') id: string, @User() user) {
  // ุงูุชุญูู ูู ุฃู ุงูุจุญุซ ูุฎุต ุงูุจุงุญุซ
  const revision = await this.revisionsService.findOne(id);
  if (revision.research.user_id !== user.id) {
    throw new ForbiddenException();
  }
  // ...
}
```

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ (TODO)

### ุนุฏุฏ ุงูุชุนุฏููุงุช ููู ุจุญุซ
```sql
SELECT 
  r.research_number,
  r.title,
  COUNT(rr.id) as revision_count
FROM research r
LEFT JOIN research_revisions rr ON r.id = rr.research_id
GROUP BY r.id
ORDER BY revision_count DESC;
```

### ูุชูุณุท ููุช ุงูุชุนุฏูู
```sql
SELECT 
  AVG(EXTRACT(EPOCH FROM (submitted_at - created_at))/86400) as avg_days
FROM research_revisions
WHERE status = 'submitted';
```

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### 1. ุฑูุน ุงููููุงุช ุงููุนูู
- [ ] ุชูุงูู ูุน AWS S3
- [ ] ุฃู ุชูุงูู ูุน Cloudinary
- [ ] ูุนุงูุฌุฉ ุงููููุงุช ุงููุจูุฑุฉ
- [ ] Progress bar

### 2. ูุธุงู ุงูุฅุดุนุงุฑุงุช
- [ ] ุฅุดุนุงุฑ ุจุฑูุฏ ุฅููุชุฑููู ููุจุงุญุซ ุนูุฏ ุทูุจ ุงูุชุนุฏูู
- [ ] ุฅุดุนุงุฑ ูููุญูููู ุนูุฏ ุฅุฑุณุงู ุงููุณุฎุฉ ุงููุนุฏูุฉ
- [ ] ุชูุจููุงุช ุงูู deadline

### 3. ุชุญุณููุงุช UI/UX
- [ ] ุนุฑุถ ุชุงุฑูุฎ ุฌููุน ุงูุชุนุฏููุงุช
- [ ] ููุงุฑูุฉ ุจูู ุงููุณุฎ (diff viewer)
- [ ] ุชุญููู ุงููุณุฎ ุงูุณุงุจูุฉ
- [ ] ูุนุงููุฉ PDF ูุจุงุดุฑุฉ

### 4. ุงูุชูุงุฑูุฑ
- [ ] Dashboard ููุฅุญุตุงุฆูุงุช
- [ ] ุชูุงุฑูุฑ ุงูุชุนุฏููุงุช
- [ ] ูุนุฏูุงุช ุงููุจูู ุจุนุฏ ุงูุชุนุฏูู

## ๐ ุงูููุงุฑุฏ

### ุงููููุงุช ุงููุฑุฌุนูุฉ
- `REVISION_SYSTEM_UPDATES.md` - ุดุฑุญ ุชูุตููู ููุชุญุฏูุซุงุช
- `REVISION_SUMMARY_AR.md` - ููุฎุต ุณุฑูุน ุจุงูุนุฑุจูุฉ
- `TESTING_GUIDE_AR.md` - ุฏููู ุงูุงุฎุชุจุงุฑ ุงููุงูู

### ุงูููุฏ ุงููุตุฏุฑู
- `/apps/frontend/src/services/research-revisions.service.ts`
- `/apps/frontend/src/pages/dashboard/ReviseResearchPage.tsx`
- `/apps/frontend/src/pages/dashboard/PendingDecisionPage.tsx`
- `/apps/backend/src/modules/research-revisions/`

## ๐ค ุงููุณุงููุฉ

ุนูุฏ ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ:
1. ุญุฏุซ ุงูู DTOs ูู ุงูู backend
2. ุญุฏุซ ุงูู service ูู ุงูู frontend
3. ุญุฏุซ ุงูู UI components
4. ุฃุถู tests
5. ุญุฏุซ ุงูุชูุซูู

## ๐ ุงูููุงุญุธุงุช ุงูููุงุฆูุฉ

- โ ุงููุธุงู ูุนูู ุจุดูู ูุชูุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุฌููุน ุงูุจูุงูุงุช ูุญููุธุฉ ุจุดูู ุตุญูุญ
- โ ุงูููู ุงูุฌุฏูุฏ ูุญู ูุญู ุงููุฏูู
- โ ุชุชุจุน ูุงูู ููุชุนุฏููุงุช
- โ๏ธ ุฑูุน ุงููููุงุช ูุญุชุงุฌ ุชูุงูู ูุน S3/Cloudinary
- โ๏ธ ุงูุฅุดุนุงุฑุงุช ุชุญุชุงุฌ ุชุทุจูู
- โ๏ธ ุงูุตูุงุญูุงุช ุชุญุชุงุฌ ุชุญุณูู

## ๐ ุงูุฏุนู

ููุฃุณุฆูุฉ ุฃู ุงููุดุงูู:
1. ุฑุงุฌุน `TESTING_GUIDE_AR.md`
2. ุชุญูู ูู console logs
3. ุฑุงุฌุน ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. ุงูุญุต network requests

---

**ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ:** Cascade AI  
**ุงูุชุงุฑูุฎ:** 2024  
**ุงูุฅุตุฏุงุฑ:** 1.0.0
