# ğŸ”” Ù…Ø±Ø¬Ø¹ Ø³Ø±ÙŠØ¹ - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª

## Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„

| # | Ø§Ù„Ø­Ø¯Ø« | Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙˆÙ† | Ø§Ù„Ø¹Ù†ÙˆØ§Ù† | Ø§Ù„Ø±Ø³Ø§Ù„Ø© | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø¯Ø§Ù„Ø© |
|---|-------|-----------|---------|---------|-------|--------|
| 1 | **Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø­Ø«** | Ù…Ø­Ø±Ø± + Ø£Ø¯Ù…Ù† | Ø¨Ø­Ø« Ø¬Ø¯ÙŠØ¯ ØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡ | ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø­Ø« Ø¬Ø¯ÙŠØ¯: {title} | `research.service.ts` | `create()` |
| 2 | **ØªØ¹ÙŠÙŠÙ† Ù…Ø­ÙƒÙ…** | Ù…Ø­ÙƒÙ… | ØªÙ… ØªØ¹ÙŠÙŠÙ†Ùƒ ÙƒÙ…Ø­ÙƒÙ… | ØªÙ… ØªØ¹ÙŠÙŠÙ†Ùƒ Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø­Ø«: {title} | `reviewer-assignments.service.ts` | `create()` |
| 3 | **Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚ÙŠÙŠÙ…** | Ø¨Ø§Ø­Ø« + Ù…Ø­Ø±Ø± + Ø£Ø¯Ù…Ù† | ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯ | ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ù„Ø¨Ø­Ø«Ùƒ: {title} | `reviews.service.ts` | `create()` |
| 4 | **Ø·Ù„Ø¨ ØªØ¹Ø¯ÙŠÙ„Ø§Øª** | Ø¨Ø§Ø­Ø« | Ù…Ø·Ù„ÙˆØ¨ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø¨Ø­Ø«Ùƒ | ÙŠØ±Ø¬Ù‰ Ø¥Ø¬Ø±Ø§Ø¡ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø¨Ø­Ø«Ùƒ: {title} | `research.service.ts` | `updateStatus()` |
| 5 | **Ø¥Ø±Ø³Ø§Ù„ ØªØ¹Ø¯ÙŠÙ„Ø§Øª** | Ù…Ø­ÙƒÙ… + Ù…Ø­Ø±Ø± + Ø£Ø¯Ù…Ù† | ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù†Ø³Ø®Ø© Ù…Ø¹Ø¯Ù„Ø© | ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù†Ø³Ø®Ø© Ù…Ø¹Ø¯Ù„Ø© Ù…Ù† Ø§Ù„Ø¨Ø­Ø«: {title} | `research-revisions.service.ts` | `submitRevision()` |
| 6 | **Ù‚Ø¨ÙˆÙ„ Ø¨Ø­Ø«** | Ø¨Ø§Ø­Ø« | ğŸ‰ ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¨Ø­Ø«Ùƒ! | ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¨Ø­Ø«Ùƒ: {title} | `research.service.ts` | `updateStatus()` |
| 7 | **Ø±ÙØ¶ Ø¨Ø­Ø«** | Ø¨Ø§Ø­Ø« | Ù‚Ø±Ø§Ø± Ø¨Ø®ØµÙˆØµ Ø¨Ø­Ø«Ùƒ | Ù†Ø£Ø³Ù Ù„Ø¥Ø¨Ù„Ø§ØºÙƒ Ø¨Ø£Ù† Ø¨Ø­Ø«Ùƒ: {title} Ù„Ù… ÙŠØªÙ… Ù‚Ø¨ÙˆÙ„Ù‡ | `research.service.ts` | `updateStatus()` |
| 8 | **Ù†Ø´Ø± Ø¨Ø­Ø«** | Ø¨Ø§Ø­Ø« | ğŸŠ ØªÙ… Ù†Ø´Ø± Ø¨Ø­Ø«Ùƒ! | ØªÙ… Ù†Ø´Ø± Ø¨Ø­Ø«Ùƒ: {title} ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø© | `research.service.ts` | `updateStatus()` |

---

## Ø§Ù„Ø¯ÙˆØ§Ù„ ÙÙŠ NotificationsService

```typescript
// Backend: apps/backend/src/modules/notifications/notifications.service.ts

âœ… notifyResearchSubmitted(researchId, researchTitle, researcherId)
âœ… notifyReviewerAssigned(researchId, researchTitle, reviewerId)
âœ… notifyReviewSubmitted(researchId, researchTitle, researcherId)
âœ… notifyRevisionRequested(researchId, researchTitle, researcherId)
âœ… notifyRevisionSubmitted(researchId, researchTitle, reviewerIds[])
âœ… notifyResearchAccepted(researchId, researchTitle, researcherId)
âœ… notifyResearchRejected(researchId, researchTitle, researcherId)
âœ… notifyResearchPublished(researchId, researchTitle, researcherId)
```

---

## API Endpoints

```typescript
// Backend: apps/backend/src/modules/notifications/notifications.controller.ts

GET    /api/notifications                    // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
GET    /api/notifications/user/:userId       // Ø¬Ù„Ø¨ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…Ø³ØªØ®Ø¯Ù…
GET    /api/notifications/user/:userId/unread-count  // Ø¹Ø¯Ø¯ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
GET    /api/notifications/:id                // Ø¬Ù„Ø¨ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§Ø­Ø¯
POST   /api/notifications                    // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø±
PATCH  /api/notifications/:id                // ØªØ­Ø¯ÙŠØ« Ø¥Ø´Ø¹Ø§Ø±
PATCH  /api/notifications/:id/read           // ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡
PATCH  /api/notifications/read-all           // ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡
DELETE /api/notifications/:id                // Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±
DELETE /api/notifications/read               // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
POST   /api/notifications/broadcast          // Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
```

---

## Frontend Service Methods

```typescript
// Frontend: apps/frontend/src/services/notifications.service.ts

âœ… getAll(filters?)                  // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
âœ… getUnreadCount()                  // Ø¹Ø¯Ø¯ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
âœ… markAsRead(id)                    // ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡
âœ… markAllAsRead()                   // ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡
âœ… delete(id)                        // Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±
âœ… deleteAllRead()                   // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
âœ… create(data)                      // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± (Admin)
âœ… broadcastToAll(data)              // Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Admin)
âœ… getUserNotifications(userId)      // Ø¬Ù„Ø¨ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…Ø³ØªØ®Ø¯Ù…
```

---

## Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### Backend - Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±:

```typescript
// ÙÙŠ Ø£ÙŠ service
constructor(
  private readonly notificationsService: NotificationsService,
) {}

async someMethod() {
  // ... your logic
  
  // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±
  await this.notificationsService.notifyResearchSubmitted(
    research.id,
    research.title,
    research.user_id
  );
}
```

### Frontend - Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª:

```typescript
import notificationsService from '@/services/notifications.service';

// Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
const notifications = await notificationsService.getAll();

// Ø¬Ù„Ø¨ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø© ÙÙ‚Ø·
const unread = await notificationsService.getAll({ is_read: false });

// Ø¹Ø¯Ø¯ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
const count = await notificationsService.getUnreadCount();

// ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡
await notificationsService.markAsRead(notificationId);
```

---

## Notification Types

```typescript
export enum NotificationType {
  // Research
  RESEARCH_SUBMITTED = 'research_submitted',
  RESEARCH_ACCEPTED = 'research_accepted',
  RESEARCH_REJECTED = 'research_rejected',
  RESEARCH_PUBLISHED = 'research_published',
  
  // Review
  REVIEWER_ASSIGNED = 'reviewer_assigned',
  REVIEW_SUBMITTED = 'review_submitted',
  REVISION_REQUESTED = 'revision_requested',
  REVISION_SUBMITTED = 'revision_submitted',
  
  // User
  ACCOUNT_CREATED = 'account_created',
  ACCOUNT_APPROVED = 'account_approved',
  ACCOUNT_SUSPENDED = 'account_suspended',
  PASSWORD_CHANGED = 'password_changed',
  
  // System
  SYSTEM_ANNOUNCEMENT = 'system_announcement',
  SYSTEM_MAINTENANCE = 'system_maintenance',
  GENERAL = 'general',
}
```

---

## Database Schema

```sql
CREATE TABLE notifications (
  id UUID PRIMARY KEY,
  user_id UUID NOT NULL,
  type VARCHAR(50) NOT NULL,
  title VARCHAR(255) NOT NULL,
  message TEXT NOT NULL,
  action_url VARCHAR(500),
  research_id UUID,
  link VARCHAR(500),
  is_read BOOLEAN DEFAULT FALSE,
  read_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

---

## Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ù‡Ù…Ø©

### Backend:
```
ğŸ“ apps/backend/src/modules/notifications/
  â”œâ”€â”€ notifications.service.ts          â­ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  â”œâ”€â”€ notifications.controller.ts       â­ API Endpoints
  â”œâ”€â”€ notifications.module.ts
  â”œâ”€â”€ dto/
  â”‚   â”œâ”€â”€ create-notification.dto.ts
  â”‚   â”œâ”€â”€ update-notification.dto.ts
  â”‚   â””â”€â”€ broadcast-notification.dto.ts
  â””â”€â”€ entities/
      â””â”€â”€ notification.entity.ts

ğŸ“ apps/backend/src/modules/research/
  â”œâ”€â”€ research.service.ts               â­ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø­Ø«
  â””â”€â”€ research.module.ts

ğŸ“ apps/backend/src/modules/reviews/
  â”œâ”€â”€ reviews.service.ts                â­ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
  â””â”€â”€ reviews.module.ts

ğŸ“ apps/backend/src/modules/reviewer-assignments/
  â”œâ”€â”€ reviewer-assignments.service.ts   â­ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØ¹ÙŠÙŠÙ†
  â””â”€â”€ reviewer-assignments.module.ts

ğŸ“ apps/backend/src/modules/research-revisions/
  â”œâ”€â”€ research-revisions.service.ts     â­ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
  â””â”€â”€ research-revisions.module.ts
```

### Frontend:
```
ğŸ“ apps/frontend/src/
  â”œâ”€â”€ services/
  â”‚   â””â”€â”€ notifications.service.ts      â­ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  â”œâ”€â”€ pages/dashboard/
  â”‚   â””â”€â”€ NotificationsPage.tsx         â­ ØµÙØ­Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  â””â”€â”€ components/dashboard/
      â”œâ”€â”€ DashboardLayout.tsx            â­ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
      â””â”€â”€ NotificationCard.tsx
```

---

## Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©

### ØªØ´ØºÙŠÙ„ Backend:
```bash
cd /home/belal/Documents/my-journal
npx nx serve backend
```

### ØªØ´ØºÙŠÙ„ Frontend:
```bash
cd /home/belal/Documents/my-journal
npx nx serve frontend
```

### Build Backend:
```bash
npx nx build backend
```

### Build Frontend:
```bash
npx nx build frontend
```

---

## Troubleshooting

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ø§ ØªØ¸Ù‡Ø±
**Ø§Ù„Ø­Ù„:**
1. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Backend ÙŠØ¹Ù…Ù„
2. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
3. Ø§ÙØªØ­ Console ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø®Ø·Ø§Ø¡
4. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù€ API endpoint ØµØ­ÙŠØ­

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ø§ ÙŠØªØ­Ø¯Ø«
**Ø§Ù„Ø­Ù„:**
1. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† event `notificationsUpdated` ÙŠØªÙ… Ø¥Ø·Ù„Ø§Ù‚Ù‡
2. Ø§ÙØªØ­ `DashboardLayout.tsx` ÙˆØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ event listener
3. Ø¬Ø±Ø¨ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Build Error
**Ø§Ù„Ø­Ù„:**
1. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ«Ø¨ÙŠØª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ dependencies
2. Ù†ÙØ° `npm install` ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
3. Ù†ÙØ° `npx nx reset` Ù„Ù…Ø³Ø­ Ø§Ù„Ù€ cache
4. Ø¬Ø±Ø¨ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰

---

## ğŸ“ Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª

- **Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„**: `NOTIFICATIONS_SYSTEM_COMPLETE.md`
- **Ø§Ù„Ù…Ù„Ø®Øµ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©**: `NOTIFICATIONS_SUMMARY_AR.md`
- **Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹**: `NOTIFICATIONS_STATUS.md`

---

**âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…ÙƒØªÙ…Ù„ ÙˆØ¬Ø§Ù‡Ø²!**
