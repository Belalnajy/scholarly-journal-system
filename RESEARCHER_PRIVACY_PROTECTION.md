# ุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ - ุชูููุฏ ุตูุงุญูุงุช ุงููุญูููู

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุชุทุจูู ุฅุฌุฑุงุกุงุช ุญูุงูุฉ ููููุฉ ุงูุจุงุญุซ ูู ุฎูุงู ุชูููุฏ ุตูุงุญูุงุช ุงููุญูููู ูู ุชุนุฏูู ูููุงุช ุงูุฃุจุญุงุซ.

## ุงูุชุบููุฑุงุช ุงููุทุจูุฉ

### ๐ Backend Changes

#### 1. ุฅุฒุงูุฉ endpoint ูููุญูููู
**ุงูููู:** `apps/backend/src/modules/research/research.controller.ts`

- โ **ุชู ุฅุฒุงูุฉ:** `POST /research/:id/upload-edited-by-reviewer`
- **ุงูุณุจุจ:** ููุน ุงููุญูููู ูู ุชุนุฏูู ูููุงุช ุงูุฃุจุญุงุซ ูุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ

#### 2. ุชุญุฏูุซ ุตูุงุญูุงุช ุงูุชุนุฏูู
**ุงูููู:** `apps/backend/src/modules/research/research.service.ts`

**ุงูุชุญุฏูุซุงุช:**

##### ุฃ) ุชุญุฏูุซ `update()` method
```typescript
async update(
  id: string,
  updateResearchDto: UpdateResearchDto,
  user?: any  // ูุนุงูู ุฌุฏูุฏ ููุชุญูู ูู ุงูุตูุงุญูุงุช
): Promise<Research>
```

**ููุทู ุงูุชุญูู:**
- โ ุงูุจุงุญุซ ุตุงุญุจ ุงูุจุญุซ ููููู ุงูุชุนุฏูู
- โ ุงูุฃุฏูู ููููู ุงูุชุนุฏูู
- โ ุงููุญุฑุฑ ููููู ุงูุชุนุฏูู
- โ ุงููุญูู **ูุง ููููู** ุงูุชุนุฏูู

##### ุจ) ุชุญุฏูุซ `updateResearchFile()` method
**ููุฏ ุฌุฏูุฏ:** ูุง ูููู ุชุนุฏูู ุงูููู ุจุนุฏ ุชุนููู ุงููุญูููู

```typescript
// ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ูุญูููู ูุนูููู
const reviewerAssignments = await this.researchRepository.manager.query(
  `SELECT COUNT(*) as count FROM reviewer_assignment WHERE research_id = $1`,
  [research_id]
);

const hasReviewers = reviewerAssignments[0]?.count > 0;

if (hasReviewers) {
  throw new ForbiddenException(
    'ูุง ูููู ุชุนุฏูู ุงูููู ุจุนุฏ ุชุนููู ุงููุญูููู. ูุฐุง ุงูุฅุฌุฑุงุก ูุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ.'
  );
}
```

**ุงููุฏู:** ุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ ุจููุน ุชุนุฏูู ุงูููู ุจุนุฏ ูุตููู ูููุญูููู

### ๐จ Frontend Changes

#### 1. ุฅุฒุงูุฉ ูุงุฌูุฉ ุฑูุน ุงูููู ุงููุนุฏู
**ุงูููู:** `apps/frontend/src/pages/dashboard/reviewer/EvaluationFormPage.tsx`

**ุงูุชุบููุฑุงุช:**
- โ ุฅุฒุงูุฉ ูุณู "ุฑูุน ููู ูุนุฏู"
- โ ุฅุฒุงูุฉ `editedFile` state
- โ ุฅุฒุงูุฉ `isUploadingFile` state
- โ ุฅุฒุงูุฉ `handleFileChange()` function
- โ ุฅุฒุงูุฉ `handleUploadEditedFile()` function
- โ ุฅุฒุงูุฉ ุงุณุชูุฑุงุฏ `Upload` icon

**ุชู ุงุณุชุจุฏุงูู ุจู:**
```tsx
{/* Privacy Notice */}
<div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
  <div className="flex items-start gap-3">
    <AlertCircle className="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" />
    <div>
      <h3 className="font-bold text-gray-800 mb-1">
        ููุงุญุธุฉ ูุงูุฉ
      </h3>
      <p className="text-sm text-gray-600">
        ุชู ุฅุฒุงูุฉ ุฎุงุตูุฉ ุชุนุฏูู ุงูููู ูู ุงููุญูููู ูุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ. 
        ููููู ููุท ุชุญููู ุงูุจุญุซ ููุฑุงุฌุนุชู ูุชููููู.
      </p>
    </div>
  </div>
</div>
```

#### 2. ุฅุฒุงูุฉ ุงููุธููุฉ ูู Service
**ุงูููู:** `apps/frontend/src/services/researchService.ts`

- โ ุฅุฒุงูุฉ `uploadEditedByReviewer()` function
- ุชู ุงุณุชุจุฏุงููุง ุจุชุนููู ุชูุถูุญู

## ุงูุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ

### ๐ ุฌุฏูู ุงูุตูุงุญูุงุช

| ุงูุนูููุฉ | ุงูุจุงุญุซ | ุงููุญูู | ุงููุญุฑุฑ | ุงูุฃุฏูู |
|---------|--------|--------|---------|--------|
| **ุนุฑุถ ุงูุจุญุซ** | โ (ุจุญุซู) | โ (ุงููุนูู ูู) | โ | โ |
| **ุชุนุฏูู ุงูุจุญุซ** | โ (ุจุญุซู) | โ | โ | โ |
| **ุชุนุฏูู ุงูููู** | โ (ูุจู ุงูุชูุฏูู) | โ | โ (ูุจู ุชุนููู ุงููุญูููู) | โ (ูุจู ุชุนููู ุงููุญูููู) |
| **ุชุญููู ุงูุจุญุซ** | โ | โ | โ | โ |
| **ุชูููู ุงูุจุญุซ** | โ | โ | โ | โ |

## ุณูุฑ ุงูุนูู ุงููุญุฏุซ

### ๐ ูุจู ุชุนููู ุงููุญูููู

```
1. ุงูุจุงุญุซ ูุฑูุน ุงูุจุญุซ
   โ
2. ุงูุฃุฏูู/ุงููุญุฑุฑ ูุฑุงุฌุน ุงูุจุญุซ
   โ
3. [ุงุฎุชูุงุฑู] ุงูุฃุฏูู/ุงููุญุฑุฑ ูุนุฏู ุงูููู (ูุซู: ุฅุฒุงูุฉ ุงุณู ุงูุจุงุญุซ)
   โ
4. ุงูุฃุฏูู/ุงููุญุฑุฑ ูุนูู ุงููุญูููู
   โ
5. ๐ ุงูููู ูุตุจุญ ูุญูู (ูุง ูููู ุชุนุฏููู)
```

### ๐ฏ ุจุนุฏ ุชุนููู ุงููุญูููู

```
ุงููุญูู ูุณุชูู ุงูุจุญุซ
   โ
ุงููุญูู ูุญูู ุงูุจุญุซ ูููุฑุงุฌุนุฉ
   โ
ุงููุญูู ูููู ุงูุจุญุซ
   โ
ุงููุญูู ูุฑุณู ุงูุชูููู
   
โ ูุง ูููู ูููุญูู ุชุนุฏูู ุงูููู
โ ูููู ูููุญูู ููุท ุงููุฑุงุฌุนุฉ ูุงูุชูููู
```

## ุงูุฃูุงู ูุงูุฎุตูุตูุฉ

### ๐ก๏ธ ุฅุฌุฑุงุกุงุช ุงูุญูุงูุฉ

1. **ุญูุงูุฉ ุงููููุฉ:**
   - ุงููุญูู ูุง ููููู ุงููุตูู ููุนูููุงุช ุงูุจุงุญุซ ุงูุดุฎุตูุฉ
   - ุงููุญูู ูุง ููููู ุชุนุฏูู ุงูููู ูุฅุถุงูุฉ/ุญุฐู ูุนูููุงุช

2. **ุงูุชุญูู ูู ุงููุตูู:**
   - ููุท ุงูุฃุฏูู ูุงููุญุฑุฑ ูููููู ุชุนุฏูู ุงูููู ูุจู ุงูุชุญููู
   - ุจุนุฏ ุชุนููู ุงููุญููููุ ุงูููู ูุตุจุญ ูููุฑุงุกุฉ ููุท

3. **ุงูุชุชุจุน:**
   - ุฌููุน ุงูุชุนุฏููุงุช ุนูู ุงูููู ูุชู ุชุณุฌูููุง
   - ูุชู ุญูุธ `file_updated_by` ู `file_updated_at`

## ุฑุณุงุฆู ุงูุฎุทุฃ

### Backend Error Messages

```typescript
// ุนูุฏ ูุญุงููุฉ ุชุนุฏูู ุจุญุซ ุจุฏูู ุตูุงุญูุฉ
throw new ForbiddenException('ููุณ ูุฏูู ุตูุงุญูุฉ ูุชุนุฏูู ูุฐุง ุงูุจุญุซ');

// ุนูุฏ ูุญุงููุฉ ุชุนุฏูู ุงูููู ุจุนุฏ ุชุนููู ุงููุญูููู
throw new ForbiddenException(
  'ูุง ูููู ุชุนุฏูู ุงูููู ุจุนุฏ ุชุนููู ุงููุญูููู. ูุฐุง ุงูุฅุฌุฑุงุก ูุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ.'
);
```

### Frontend User Messages

```
โ "ุชู ุฅุฒุงูุฉ ุฎุงุตูุฉ ุชุนุฏูู ุงูููู ูู ุงููุญูููู ูุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ"
```

## ุงูุงุฎุชุจุงุฑ

### โ ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

1. **ุงููุญูู ูุญุงูู ุชุนุฏูู ุงูุจุญุซ:**
   - โ ูุฌุจ ุฃู ููุดู
   - ุฑุณุงูุฉ: "ููุณ ูุฏูู ุตูุงุญูุฉ ูุชุนุฏูู ูุฐุง ุงูุจุญุซ"

2. **ุงูุฃุฏูู ูุญุงูู ุชุนุฏูู ุงูููู ูุจู ุชุนููู ุงููุญูููู:**
   - โ ูุฌุจ ุฃู ููุฌุญ

3. **ุงูุฃุฏูู ูุญุงูู ุชุนุฏูู ุงูููู ุจุนุฏ ุชุนููู ุงููุญูููู:**
   - โ ูุฌุจ ุฃู ููุดู
   - ุฑุณุงูุฉ: "ูุง ูููู ุชุนุฏูู ุงูููู ุจุนุฏ ุชุนููู ุงููุญูููู"

4. **ุงููุญูู ูุญุงูู ุงููุตูู ูุตูุญุฉ ุงูุชูููู:**
   - โ ููููู ุนุฑุถ ุงูุจุญุซ
   - โ ููููู ุชุญููู ุงูุจุญุซ
   - โ ูุง ููุฌุฏ ุฎูุงุฑ ูุชุนุฏูู ุงูููู
   - โ ูุธูุฑ ุฅุดุนุงุฑ ุญูุงูุฉ ุงูุฎุตูุตูุฉ

## ุงููููุงุช ุงููุนุฏูุฉ

### Backend
- โ๏ธ `apps/backend/src/modules/research/research.controller.ts`
- โ๏ธ `apps/backend/src/modules/research/research.service.ts`

### Frontend
- โ๏ธ `apps/frontend/src/pages/dashboard/reviewer/EvaluationFormPage.tsx`
- โ๏ธ `apps/frontend/src/services/researchService.ts`

### Documentation
- ๐ `RESEARCHER_PRIVACY_PROTECTION.md` (ูุฐุง ุงูููู)

## ุงูุฎูุงุตุฉ

โ **ุชู ุชุทุจูู:**
- ููุน ุงููุญูููู ูู ุชุนุฏูู ูููุงุช ุงูุฃุจุญุงุซ
- ููุน ุชุนุฏูู ุงููููุงุช ุจุนุฏ ุชุนููู ุงููุญูููู
- ุฅุถุงูุฉ ุฑุณุงุฆู ุชูุถูุญูุฉ ูููุณุชุฎุฏููู
- ุชุญุฏูุซ ุงูุตูุงุญูุงุช ูู Backend ู Frontend

๐ฏ **ุงููุฏู ุงููุญูู:**
ุญูุงูุฉ ูููุฉ ุงูุจุงุญุซ ูู ุงููุญูููู ูุน ุงูุญูุงุธ ุนูู ูุฏุฑุฉ ุงูุฃุฏูู ูุงููุญุฑุฑ ุนูู ุฅุฏุงุฑุฉ ุงููููุงุช ูุจู ุงูุชุญููู.
